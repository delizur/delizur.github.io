<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>OASYS Project · Danny Elizur</title>
  <meta name="description" content="Working with the Canadian Space Agency on a levelling system for the OASYS Lunar Greenhouse.">
  <link rel="icon" href="/assets/favicon.png" />
  <link rel="stylesheet" href="/assets/css/site-base.css">
  <style>
  :root{--bg:#ffffff;--panel:#f8fafc;--text:#0f172a;--muted:#334155;--brand:#38bdf8;--accent:#c084fc;--ring:#22d3ee}
  body{margin:0;font-family:ui-sans-serif,system-ui,Segoe UI,Roboto,Helvetica,Arial;background:var(--bg);color:var(--text);font-size:17px}
    header{background:var(--panel);padding:12px 16px;border-bottom:1px solid rgba(15,23,42,.06)}
    .nav{max-width:1000px;margin:auto;display:flex;align-items:center;justify-content:space-between}
  .brand{display:flex;gap:10px;align-items:center;font-weight:700;letter-spacing:.3px}
  .brand .dot{width:10px;height:10px;border-radius:999px;background:linear-gradient(135deg,#38bdf8,#c084fc);box-shadow:0 0 0 3px rgba(56,189,248,0.3)}
    .nav > div{display:flex;align-items:center;gap:8px}
  /* Improved icon sizing to avoid clipping and match homepage */
  .nav .icon, .pill .icon, svg.icon{width:20px;height:20px;display:inline-block;vertical-align:middle;overflow:visible}
  /* Ensure SVGs inside nav/pill/button are not clipped and align nicely */
  svg.icon, .nav svg, .pill svg{overflow:visible}
  .nav, .pill, .btn{overflow:visible;line-height:1;display:flex;align-items:center}
  .pill{display:inline-flex;gap:6px;align-items:center;padding:6px 10px;border-radius:999px;border:1px solid rgba(15,23,42,0.06)}
  .pill svg, .btn svg{display:block}
  /* prevent stroke scaling issues that sometimes clip artwork */
  svg.icon *{vector-effect:non-scaling-stroke}
  /* Button styling consistent with homepage */
  .btn{display:inline-flex;align-items:center;gap:8px;padding:8px 10px;border-radius:12px;background:linear-gradient(135deg,#38bdf8,#c084fc);color:#06131c;font-weight:700;border:none;cursor:pointer}
  .btn:focus{outline:3px solid #22d3ee}
  /* underline for theme/resume button (match homepage behavior) */
  .btn::after{content:'';position:absolute;left:8px;right:8px;bottom:6px;height:2px;background:#000;transform:scaleX(0);transform-origin:left center;transition:transform .16s ease,opacity .16s ease;border-radius:2px;opacity:0}
  .btn:hover::after,.btn:focus::after{transform:scaleX(1);opacity:1}
    .nav a{color:inherit;text-decoration:none;margin-left:10px}
    /* match homepage nav link appearance/hover */
    .nav a{padding:8px 10px;border-radius:10px}
    .nav a:hover{outline:1px dashed color-mix(in oklab, var(--brand, #38bdf8) 40%, transparent)}
    main{max-width:1000px;margin:24px auto;padding:24px}
  .card{background:var(--panel);border-radius:12px;padding:20px;border:1px solid rgba(15,23,42,.04)}
  .back-home{display:inline-block;color:var(--muted);text-decoration:none;margin-bottom:12px}
  .back-home:hover{text-decoration:underline}
  img{max-width:100%;height:auto;border-radius:10px;display:block}
  .figure-wrap{position:relative;flex:0 0 calc(50% - 12px);width:calc(50% - 12px);aspect-ratio:16/9;overflow:hidden;min-width:140px}
  .figure-wrap .caption{position:absolute;left:8px;right:8px;bottom:8px;padding:6px 10px;background:rgba(255,255,255,0.9);color:var(--text);font-size:0.9rem;border-radius:8px;opacity:0;transform:translateY(6px);transition:opacity .18s,transform .18s}
  .figure-wrap:hover .caption{opacity:1;transform:none}
  .gallery{display:flex;gap:12px;flex-wrap:wrap;margin:12px 0}
  .figure-empty{width:100%;min-height:160px;border-radius:10px;background:transparent}
  .figure-wrap img{width:100%;height:100%;object-fit:contain;object-position:center;display:block}
  /* CSA logo: increase allowed size . */
  .figure-wrap img[alt="Canadian Space Agency"]{width:auto;height:auto;max-width:95%;max-height:95%;margin:0 auto;display:block;object-fit:contain;background:#000}
  /* Make the figure container match the CSA logo background so the padding color is visually identical */
  .figure-wrap.csa{background:#000}
  @media (max-width:700px){.figure-wrap{flex-basis:100%;max-width:100%}}
    footer{max-width:1000px;margin:40px auto;color:var(--muted);padding:0 24px}
    .tags{margin:10px 0}
    .tag{display:inline-block;background:rgba(15,23,42,0.03);padding:6px 10px;border-radius:999px;margin-right:8px;color:var(--muted)}
    /* Dark mode support (system + class override) */
    @media (prefers-color-scheme: dark){
      :root{--bg:#0b1220;--panel:#0f1724;--text:#e6eef8;--muted:#9fb2c9}
      body{background:var(--bg);color:var(--text)}
      header, .card{background:var(--panel)}
      .figure-wrap .caption{background:rgba(6,10,16,0.7);color:var(--text)}
      /* Force dark caption text for white-padded thumbnails (BIoT/CSA) so captions are readable in dark mode */
      .figure-wrap.biot .caption,
      .figure-wrap.csa .caption,
      .figure-wrap img[alt="Canadian Space Agency"] + .caption,
      .figure-wrap img[alt="UBC BIoT"] + .caption{
        background:rgba(255,255,255,0.95) !important;
        color:#06131c !important;
      }
      .img-modal{background:rgba(2,6,23,0.85)}
      .img-close{color:#fff}
    }
    html.dark, body.dark{--bg:#0b1220;--panel:#0f1724;--text:#e6eef8;--muted:#9fb2c9}
  </style>
  <link rel="stylesheet" href="/assets/css/dark-caption-fix.css">
</head>
<body>
  <header>
    <nav class="nav" aria-label="Primary">
      <a class="brand" href="/"><span class="dot" aria-hidden="true"></span> <span>Danny Elizur</span></a>
    <div class="row">
  <a href="/#about">About</a>
  <a href="/#projects">Projects</a>
  <a href="/#design-teams">Design Teams</a>
  <a href="/#experience">Experience</a>
  <a href="/#education">Education</a>
  <a href="/#contact">Contact</a>
        <button id="theme" class="btn" aria-label="Toggle theme" style="margin-left:8px;font-size:0.95rem;padding:8px 10px"><svg class="icon" viewBox="-2 -2 28 28" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="width:16px;height:16px;vertical-align:middle;margin-right:6px"><path d="M12 3v2m0 14v2M3 12h2m14 0h2M5.64 5.64l1.41 1.41M16.95 16.95l1.41 1.41M5.64 18.36l1.41-1.41M16.95 7.05l1.41-1.41"/><circle cx="12" cy="12" r="5"/></svg><span style="vertical-align:middle">Theme</span></button>
      </div>
    </nav>
  </header>

  <main>
    <article class="card">
      <div style="margin-bottom:8px"><a class="back-home" href="/">← Back to home</a></div>
      <h1>OASYS Project</h1>
      <p style="color:var(--muted);margin-top:6px">Levelling system for a lunar greenhouse</p>
      <span class="tag">Machine Design</span><span class="tag">Solid Mechanics</span><span class="tag">FEA</span><span class="tag">CAD</span>

      <div class="gallery">
  <div class="figure-wrap csa"><img src="/assets/OASYS%20Project/oasys_levelling_system.png" alt="Full OASYS System Rendering"><div class="caption" data-for="CSA logo">CSA Logo</div></div>
      </div>

  <p style="color:var(--muted)">Worked in a team of students under supervision of the Canadian Space Agency, to design a levelling system for their proposed OASYS lunar greenhouse. The OASYS initiative intends to enable sustainable food production for NASA’s Artemis Mission for lunar and Martian exploration. Our team was tasked with designing a system for stabilizing and levelling the OASYS greenhouse that can withstand the lunar environment for a minimum of 6 weeks. The project involved CAD modelling, material selection (considering lunar temperatures, outgassing, and effects of lunar regolith), machine design of the necessary moving components, along with FEA analysis of the entire system. Components for the levelling system were designed based on the Shigley analysis methods, relevant for sizing the screws, nuts, and bearings required. Materials were chosen to allow for sufficient performance within the extreme operating temperature range, and considerations were made to avoid cold-welding. The full in-depth report, along with our final presentation to the CSA can be found below.</p>

      <hr style="margin:32px 0;border:none;border-top:1px solid rgba(15,23,42,.08)">

      <h2 style="margin-top:24px;margin-bottom:16px">CSA Presentation</h2>
      <p style="color:var(--muted);margin-bottom:16px">OASYS Levelling System Presentation – Presentation to the Canadian Space Agency on the levelling system design.</p>

      <!-- Presentation Viewer Section -->
      <div style="border:1px solid rgba(15,23,42,.08);border-radius:12px;padding:16px;background:var(--panel);margin-bottom:24px">
        <div style="display:flex;gap:8px;align-items:center;margin-bottom:16px;flex-wrap:wrap">
          <button id="pres-pdf-prev" style="padding:8px 12px;border:1px solid rgba(15,23,42,.12);border-radius:8px;background:transparent;cursor:pointer;font-size:0.9rem" aria-label="Previous page">← Previous</button>
          <span id="pres-pdf-page-info" style="color:var(--muted);font-size:0.9rem;flex:1">Page — of —</span>
          <button id="pres-pdf-next" style="padding:8px 12px;border:1px solid rgba(15,23,42,.12);border-radius:8px;background:transparent;cursor:pointer;font-size:0.9rem" aria-label="Next page">Next →</button>
          <a id="pres-pdf-download" href="/assets/OASYS%20Project/OASYS%20Levelling%20System%20Presentation.pdf" download style="padding:8px 12px;border:1px solid rgba(15,23,42,.12);border-radius:8px;background:transparent;cursor:pointer;font-size:0.9rem;text-decoration:none;color:inherit">⬇ Download</a>
          <button id="pres-pdf-fullscreen" style="padding:8px 12px;border:1px solid rgba(15,23,42,.12);border-radius:8px;background:transparent;cursor:pointer;font-size:0.9rem" aria-label="Fullscreen">⛶ Fullscreen</button>
        </div>
        <div id="pres-pdf-container" style="border:1px solid rgba(15,23,42,.06);border-radius:8px;background:#fff;overflow:auto;max-height:600px;display:flex;justify-content:center;align-items:flex-start;padding:16px">
          <canvas id="pres-pdf-canvas" style="display:block;max-width:100%;height:auto"></canvas>
        </div>
      </div>

      <h2 style="margin-top:24px;margin-bottom:16px">Report</h2>
      <p style="color:var(--muted);margin-bottom:16px">OASYS Levelling System Report – Detailed analysis and design documentation.</p>

      <div style="border:1px solid rgba(15,23,42,.08);border-radius:12px;padding:16px;background:var(--panel);margin-bottom:24px">
        <div style="display:flex;gap:8px;align-items:center;margin-bottom:16px;flex-wrap:wrap">
          <button id="report-pdf-prev" style="padding:8px 12px;border:1px solid rgba(15,23,42,.12);border-radius:8px;background:transparent;cursor:pointer;font-size:0.9rem" aria-label="Previous page">← Previous</button>
          <span id="report-pdf-page-info" style="color:var(--muted);font-size:0.9rem;flex:1">Page — of —</span>
          <button id="report-pdf-next" style="padding:8px 12px;border:1px solid rgba(15,23,42,.12);border-radius:8px;background:transparent;cursor:pointer;font-size:0.9rem" aria-label="Next page">Next →</button>
          <a id="report-pdf-download" href="/assets/OASYS%20Project/OASYS%20Levelling%20System%20Report.pdf" download style="padding:8px 12px;border:1px solid rgba(15,23,42,.12);border-radius:8px;background:transparent;cursor:pointer;font-size:0.9rem;text-decoration:none;color:inherit">⬇ Download</a>
          <button id="report-pdf-fullscreen" style="padding:8px 12px;border:1px solid rgba(15,23,42,.12);border-radius:8px;background:transparent;cursor:pointer;font-size:0.9rem" aria-label="Fullscreen">⛶ Fullscreen</button>
        </div>
        <div id="report-pdf-container" style="border:1px solid rgba(15,23,42,.06);border-radius:8px;background:#fff;overflow:auto;max-height:600px;display:flex;justify-content:center;align-items:flex-start;padding:16px">
          <canvas id="report-pdf-canvas" style="display:block;max-width:100%;height:auto"></canvas>
        </div>
      </div>

      <style>
        .oasys-pdf-corner-btn {
          display: none;
          position: fixed;
          z-index: 10000;
          background: rgba(56, 189, 248, 0.95);
          color: #0f172a;
          border: 2px solid rgba(56, 189, 248, 1);
          border-radius: 8px;
          padding: 12px 14px;
          cursor: pointer;
          font-size: 1.2rem;
          font-weight: bold;
          box-shadow: 0 4px 12px rgba(56, 189, 248, 0.4);
        }
        .oasys-pdf-corner-btn.visible {
          display: block !important;
        }
        .oasys-pdf-corner-btn:hover {
          background: rgba(56, 189, 248, 1);
          box-shadow: 0 6px 16px rgba(56, 189, 248, 0.6);
          transform: scale(1.1);
        }
        #report-corner-prev, #pres-corner-prev {
          bottom: 20px;
          left: 20px;
        }
        #report-corner-next, #pres-corner-next {
          bottom: 20px;
          right: 20px;
        }
        #report-pdf-container:fullscreen, #pres-pdf-container:fullscreen {
          max-height: 100vh;
          padding: 20px;
        }
        #report-pdf-fullscreen-controls, #pres-pdf-fullscreen-controls {
          display: none;
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          background: rgba(15,23,42,0.95);
          color: #e6eef8;
          padding: 12px 16px;
          z-index: 10001;
          gap: 8px;
          align-items: center;
          flex-wrap: wrap;
        }
        #report-pdf-container:fullscreen ~ #report-pdf-fullscreen-controls,
        #pres-pdf-container:fullscreen ~ #pres-pdf-fullscreen-controls {
          display: flex;
        }
        #report-pdf-fullscreen-controls button, #pres-pdf-fullscreen-controls button {
          padding: 8px 12px;
          border: 1px solid rgba(230,238,248,0.2);
          border-radius: 8px;
          background: transparent;
          color: #e6eef8;
          cursor: pointer;
          font-size: 0.9rem;
        }
        #report-pdf-fullscreen-controls button:hover, #pres-pdf-fullscreen-controls button:hover {
          background: rgba(230,238,248,0.1);
        }
        /* Dark mode support for PDF buttons */
        @media (prefers-color-scheme: dark) {
          #report-pdf-prev, #report-pdf-next, #report-pdf-fullscreen, #report-pdf-download,
          #pres-pdf-prev, #pres-pdf-next, #pres-pdf-fullscreen, #pres-pdf-download {
            color: #e6eef8 !important;
            border-color: rgba(230, 238, 248, 0.2) !important;
          }
          #report-pdf-prev:hover, #report-pdf-next:hover, #report-pdf-fullscreen:hover, #report-pdf-download:hover,
          #pres-pdf-prev:hover, #pres-pdf-next:hover, #pres-pdf-fullscreen:hover, #pres-pdf-download:hover {
            background: rgba(230, 238, 248, 0.1) !important;
          }
        }
        html.dark #report-pdf-prev, html.dark #report-pdf-next, html.dark #report-pdf-fullscreen, html.dark #report-pdf-download,
        html.dark #pres-pdf-prev, html.dark #pres-pdf-next, html.dark #pres-pdf-fullscreen, html.dark #pres-pdf-download {
          color: #e6eef8 !important;
          border-color: rgba(230, 238, 248, 0.2) !important;
        }
        html.dark #report-pdf-prev:hover, html.dark #report-pdf-next:hover, html.dark #report-pdf-fullscreen:hover, html.dark #report-pdf-download:hover,
        html.dark #pres-pdf-prev:hover, html.dark #pres-pdf-next:hover, html.dark #pres-pdf-fullscreen:hover, html.dark #pres-pdf-download:hover {
          background: rgba(230, 238, 248, 0.1) !important;
        }
      </style>

      <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
      <script>
        function initPDFViewer(containerId, canvasId, pageInfoId, prevBtnId, nextBtnId, fullscreenBtnId, cornerPrevId, cornerNextId, cornerControlsId, pdfUrl) {
          const pdfjsLib = window['pdfjs-dist/build/pdf'];
          pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
          
          const canvas = document.getElementById(canvasId);
          const ctx = canvas.getContext('2d');
          const container = document.getElementById(containerId);
          const pageInfo = document.getElementById(pageInfoId);
          const prevBtn = document.getElementById(prevBtnId);
          const nextBtn = document.getElementById(nextBtnId);
          const fullscreenBtn = document.getElementById(fullscreenBtnId);
          
          let pdfDoc = null;
          let pageNum = 1;
          let pageCount = 0;
          
          function renderPage(num) {
            pdfDoc.getPage(num).then(function(page) {
              const viewport = page.getViewport({ scale: 2 });
              canvas.width = viewport.width;
              canvas.height = viewport.height;
              
              const renderContext = { canvasContext: ctx, viewport: viewport };
              page.render(renderContext);
              
              pageInfo.textContent = 'Page ' + num + ' of ' + pageCount;
              const fsPageInfo = document.getElementById(pageInfoId.replace('page-info', 'fullscreen-page-info'));
              if(fsPageInfo) fsPageInfo.textContent = 'Page ' + num + ' of ' + pageCount;
              
              prevBtn.disabled = num <= 1;
              nextBtn.disabled = num >= pageCount;
            });
          }
          
          function navigate(delta) {
            if (pageNum + delta > 0 && pageNum + delta <= pageCount) {
              pageNum += delta;
              renderPage(pageNum);
              if (document.fullscreenElement === container) {
                canvas.scrollIntoView({ behavior: 'smooth', block: 'start' });
              }
            }
          }
          
          prevBtn.addEventListener('click', function() { navigate(-1); });
          nextBtn.addEventListener('click', function() { navigate(1); });
          
          fullscreenBtn.addEventListener('click', function() {
            if (container.requestFullscreen) {
              container.requestFullscreen().then(() => {
                setTimeout(() => {
                  const cornerPrev = document.getElementById(cornerPrevId);
                  const cornerNext = document.getElementById(cornerNextId);
                  if(cornerPrev) cornerPrev.classList.add('visible');
                  if(cornerNext) cornerNext.classList.add('visible');
                }, 100);
              }).catch(err => console.error('Fullscreen error:', err));
            }
          });
          
          document.addEventListener('fullscreenchange', function() {
            const cornerPrev = document.getElementById(cornerPrevId);
            const cornerNext = document.getElementById(cornerNextId);
            if (document.fullscreenElement) {
              if(cornerPrev) cornerPrev.classList.add('visible');
              if(cornerNext) cornerNext.classList.add('visible');
            } else {
              if(cornerPrev) cornerPrev.classList.remove('visible');
              if(cornerNext) cornerNext.classList.remove('visible');
            }
          });
          
          const fsControls = document.createElement('div');
          fsControls.id = cornerControlsId;
          fsControls.innerHTML = `
            <button id="${fullscreenBtnId.replace('-fullscreen', '')}-fullscreen-prev" aria-label="Previous page">← Previous</button>
            <span id="${pageInfoId.replace('page-info', 'fullscreen-page-info')}" style="color:#e6eef8;font-size:0.9rem;flex:1">Page — of —</span>
            <button id="${fullscreenBtnId.replace('-fullscreen', '')}-fullscreen-next" aria-label="Next page">Next →</button>
            <button id="${fullscreenBtnId.replace('-fullscreen', '')}-fullscreen-exit" aria-label="Exit fullscreen">Exit ⛶</button>
          `;
          container.parentElement.insertBefore(fsControls, container.nextSibling);
          
          document.getElementById(fullscreenBtnId.replace('-fullscreen', '') + '-fullscreen-prev').addEventListener('click', function() { navigate(-1); });
          document.getElementById(fullscreenBtnId.replace('-fullscreen', '') + '-fullscreen-next').addEventListener('click', function() { navigate(1); });
          document.getElementById(fullscreenBtnId.replace('-fullscreen', '') + '-fullscreen-exit').addEventListener('click', function() {
            if (document.fullscreenElement) {
              document.exitFullscreen();
            }
          });
          
          document.addEventListener('keydown', function(e) {
            if (document.fullscreenElement === container) {
              if (e.key === 'ArrowLeft') navigate(-1);
              if (e.key === 'ArrowRight') navigate(1);
              if (e.key === 'Escape') document.exitFullscreen();
            }
          });
          
          pdfjsLib.getDocument(pdfUrl).promise.then(function(doc) {
            pdfDoc = doc;
            pageCount = doc.numPages;
            renderPage(pageNum);
          }).catch(function(error) {
            console.error('Error loading PDF:', error);
            container.innerHTML = '<p style="color:var(--muted);padding:24px">Unable to load document. You can <a href="' + pdfUrl + '">download it here</a>.</p>';
          });
        }
        
        function createCornerButtons(cornerPrevId, cornerNextId) {
          const cornerPrev = document.createElement('button');
          cornerPrev.id = cornerPrevId;
          cornerPrev.className = 'oasys-pdf-corner-btn';
          cornerPrev.setAttribute('aria-label', 'Previous page');
          cornerPrev.textContent = '←';
          cornerPrev.style.display = 'none';
          document.body.appendChild(cornerPrev);
          
          const cornerNext = document.createElement('button');
          cornerNext.id = cornerNextId;
          cornerNext.className = 'oasys-pdf-corner-btn';
          cornerNext.setAttribute('aria-label', 'Next page');
          cornerNext.textContent = '→';
          cornerNext.style.display = 'none';
          document.body.appendChild(cornerNext);
          
          return { cornerPrev, cornerNext };
        }
        
        const reportCorners = createCornerButtons('report-corner-prev', 'report-corner-next');
        const presCorners = createCornerButtons('pres-corner-prev', 'pres-corner-next');
        
        reportCorners.cornerPrev.addEventListener('click', function() {
          document.getElementById('report-pdf-prev').click();
        });
        reportCorners.cornerNext.addEventListener('click', function() {
          document.getElementById('report-pdf-next').click();
        });
        presCorners.cornerPrev.addEventListener('click', function() {
          document.getElementById('pres-pdf-prev').click();
        });
        presCorners.cornerNext.addEventListener('click', function() {
          document.getElementById('pres-pdf-next').click();
        });
        
        initPDFViewer('report-pdf-container', 'report-pdf-canvas', 'report-pdf-page-info', 'report-pdf-prev', 'report-pdf-next', 'report-pdf-fullscreen', 'report-corner-prev', 'report-corner-next', 'report-pdf-fullscreen-controls', '/assets/OASYS%20Project/OASYS%20Levelling%20System%20Report.pdf');
        initPDFViewer('pres-pdf-container', 'pres-pdf-canvas', 'pres-pdf-page-info', 'pres-pdf-prev', 'pres-pdf-next', 'pres-pdf-fullscreen', 'pres-corner-prev', 'pres-corner-next', 'pres-pdf-fullscreen-controls', '/assets/OASYS%20Project/OASYS%20Levelling%20System%20Presentation.pdf');
      </script>
      
    </article>
  </main>

  <footer>
    <div style="text-align:center;padding:16px;color:var(--muted)">© <span id="year">2025</span> Danny Elizur</div>
  </footer>
  <script>
  // Apply persisted theme from root site (if present) so project pages follow the site toggle.
  (function(){ try{ const theme = localStorage.getItem('theme'); if(theme==='dark') document.documentElement.classList.add('dark'); else if(theme==='light') document.documentElement.classList.remove('dark'); }catch(e){} })();
    document.getElementById('year').textContent=new Date().getFullYear();
    // Theme toggle on project pages: mirror the homepage behavior
    (function(){
      try{
        const btn = document.getElementById('theme');
        function applyTheme(t){ document.documentElement.classList.remove('light','dark'); if(t==='light') document.documentElement.classList.add('light'); else if(t==='dark') document.documentElement.classList.add('dark'); localStorage.setItem('theme', t); }
        btn && btn.addEventListener('click', function(){ const cur = document.documentElement.classList.contains('light') ? 'light' : 'dark'; applyTheme(cur==='light' ? 'dark' : 'light'); });
      }catch(e){}
    })();
    (function(){
      document.querySelectorAll('.figure-wrap').forEach(function(f){
        const img = f.querySelector('img');
        const cap = f.querySelector('.caption');
        if(!img || !cap) return;
        cap.textContent = img.getAttribute('data-caption') || img.alt || '';
      });

      // Image lightbox modal (shared behavior)
      (function(){
        const modal = document.createElement('div'); modal.id = 'img-modal'; modal.className = 'img-modal'; modal.setAttribute('aria-hidden','true');
        modal.innerHTML = `<div class="img-modal-content"><button id="img-close" class="img-close" aria-label="Close image">✕</button><img id="img-modal-img" alt=""/><div id="img-modal-caption" style="margin-top:8px;color:var(--muted)"></div></div>`;
        document.body.appendChild(modal);
  const style = document.createElement('style');
  style.textContent = `
  .img-modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(2,6,23,.6);z-index:10000;padding:24px}
  .img-modal[aria-hidden="false"]{display:flex}
  .img-modal-content{max-width:1000px;width:100%;background:transparent;border-radius:8px;text-align:center;display:flex;align-items:center;justify-content:center;flex-direction:column}
  .img-modal-content img{max-width:100%;max-height:80vh;height:auto;object-fit:contain;border-radius:8px;margin:0 auto}
  .img-close{position:absolute;right:28px;top:24px;background:transparent;border:0;color:#fff;font-size:28px;cursor:pointer}
  `;
        document.head.appendChild(style);
  const imgEl = document.getElementById('img-modal-img');
  const capEl = document.getElementById('img-modal-caption');
  const imgClose = document.getElementById('img-close');
  function openImg(src, alt){ imgEl.src = src; imgEl.alt = alt||''; capEl.textContent = alt||''; modal.setAttribute('aria-hidden','false'); }
  function closeImg(){ modal.setAttribute('aria-hidden','true'); imgEl.src=''; }
  document.querySelectorAll('.figure-wrap img').forEach(function(i){ i.style.cursor='zoom-in'; i.addEventListener('click', function(e){ e.preventDefault(); openImg(this.src, this.alt||''); }); });
  imgClose.addEventListener('click', closeImg);
  // close when clicking anywhere except the image itself
  modal.addEventListener('click', function(e){ if(e.target !== imgEl) closeImg(); });
  document.addEventListener('keydown', function(e){ if(e.key==='Escape') closeImg(); });
      })();
    })();
  </script>
  <script src="/assets/js/theme-toggle.js"></script>
</body>
</html>
